var style=".sta-btn{border-radius:4px;line-height:42px;cursor:pointer;font-size:16px;box-shadow:0 1px 0 rgba(255,255,255,0.15) inset,0 1px 1px rgba(0,0,0,0.15);text-shadow:0 -1px 0 rgba(0,0,0,0.25);color:#FFF;outline:0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:inline-block;margin:0;padding:0 14px}.btn-dark-green{background-color:#61C788;background-image:linear-gradient(top,#6bc88e,#52c77e);background-repeat:repeat-x;border:1px solid #1CAC52}.btn-dark-green:hover{box-shadow:0 0 6px #139142;border:1px solid #139142}.btn-grey{border:1px solid #DDDEDF;background-color:#FBFCFD;color:#9D9E9F;text-shadow:none;box-shadow:none}.sta-mask{width:100%;height:100%;top:0;left:0;position:fixed;z-index:998;background-color:rgba(0,0,0,0.4);text-align:center}.sta-container{position:fixed;top:10%;left:30%;width:40%;height:500px;z-index:1000;border-radius:10px;background:#FBFCFD}.sta-container i{font-style:normal}.sta-hide{display:none}.sta-title{height:40px;line-height:40px;font-size:1.2em;text-align:left;background-image:-webkit-linear-gradient(top,#086ED5,#055DB5);color:#fff;overflow:hidden;padding:5px 5px 5px 10px}.sta-close{float:right;font-size:1.2em;padding-right:10px}.sta-close:hover{color:red}.sta-msg{display:inline-block}.sta-toolbar{list-style:none;overflow:hidden;margin:0;padding:5px}.sta-toolbar li{float:left;margin-right:10px}.sta-toolbar .sta-changeview-btn{cursor:pointer;float:right;height:40px;line-height:40px}.sta-result{height:370px;overflow:auto;padding:10px}.sta-result table{width:100%;height:100%;text-align:center;padding-top:10px;border-collapse:collapse}.sta-result table tr:hover{background:#414243;color:#FFF}.sta-result table tr:hover a{color:#81B3D5}#tempframe{width:1px;height:1px;top:-999px;left:-999px;position:absolute}",html='<div class="sta-mask"></div><div class="sta-container"><div class="sta-title"><div class="sta-msg"></div><img src="http://static.zhihu.com/static/img/spinner/grey-loading.gif"/><i class="sta-btn sta-close" data-action="close" title="close">X</i></div><ul class="sta-toolbar"><li class="sta-btn btn-dark-green" data-action="sortResult" data-type="follower">\u5173\u6ce8\u8005</li><li class="sta-btn btn-dark-green" data-action="sortResult" data-type="ask">\u63d0\u95ee</li><li class="sta-btn btn-dark-green" data-action="sortResult" data-type="answer">\u56de\u7b54</li><li class="sta-btn btn-dark-green" data-action="sortResult" data-type="agree">\u8d5e\u540c</li><li class="sta-btn btn-dark-green" data-action="sortResult" data-type="ratio">\u8d5e\u540c/\u56de\u7b54\u6bd4</li><li class="sta-btn btn-dark-green sta-changeview-btn" data-action="changeView" >\u6539\u4e3a\u9017\u53f7\u5206\u9694</span></ul><div class="sta-result"></div><iframe id="tempframe"></iframe></div>',users="guxizhao,zou-dao-kou,xiaodaoren,cai-tong,xu-xiang-nan,unogzx,shenbin,PeterDeng,namiheike,wu-si-yang-32,yskin,jixin".split(","),answerlimit=10,agreelimit=200,ratiolimit=5,followerlimit=10,body=$(document.body),result={length:0,data:{},has:function(a){return this.data[a]},isEmpty:function(){return 0==this.length},push:function(a){this[this.length++]=a,this.data[a.id]=1}},rparam=/\$(\d)/g,userIndex=0,userLength=users.length,curSortBtn,showtable=!0,messages={wait:"\u5171$1\u4e2a\u7528\u6237\uff0c\u51c6\u5907\u626b\u63cf\u7b2c$2\u4e2a...",loading:"\u6b63\u5728\u52a0\u8f7d$1\u7684\u5173\u6ce8\u8005:$2/$3...",loaded:"$1\u7684$2\u4e2a\u5173\u6ce8\u8005\u52a0\u8f7d\u5b8c\u6210",success:"\u6240\u6709$1\u540d\u7528\u6237\u7684\u5173\u6ce8\u8005\u5df2\u7ecf\u5168\u90e8\u626b\u63cf\u5b8c\u6210\uff0c\u5171\u627e\u5230$2\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7528\u6237",comma:"\u6539\u4e3a\u9017\u53f7\u5206\u9694",table:"\u6539\u4e3a\u8868\u683c\u663e\u793a",quit:"\u786e\u8ba4\u9000\u51fa\uff1f"},strings={container:".sta-container",greyClass:"btn-grey",greenClass:"btn-dark-green"},statistic={cache:{},get:function(a){return this.cache[a]||(this.cache[a]=this.el.find(this.ATTR[a]))},init:function(){body.append($("<style>").html(style)).append(html),this.el=$(strings.container),this.initEvent(),this.loadUser()},initEvent:function(){var a=this;$.each(this.EVENT,function(b,c){var d=a.el.find(b);$.each(c,function(b,c){d.on(b,$.proxy(c,a))})})},changeView:function(a){result.isEmpty()||(showtable=!showtable,a.html(messages[showtable?"table":"comma"]),this.showResult())},loadUser:function(){var b,a=this;users.length&&(b=users.shift())?this.showMessage("wait",userLength,++userIndex).get("iframe").attr("src","/people/"+b+"/followees").load(function(){a.loadMore($(this).contents())}):this.success()},loadMore:function(a,b,c){var e,d=a.find(".zu-button-more[aria-role]"),f=this;b=b||a.find(".title-section.ellipsis a").html(),d.length?(d.get(0).click(),e=a.find(".zh-general-list .zm-profile-card .zm-list-content-medium").length,c=c||a.find(".zm-profile-side-following strong").html(),f.showMessage("loading",b,e,c),setTimeout(function(){f.loadMore(a,b,c)},2e3)):(f.showMessage("loaded",b,c),f.showRatio(a))},showRatio:function(a){for(var b,c,d,e,f,g,h,i,j,k,l=a.find(".zh-general-list .zm-list-content-medium"),m=l.length;m--;)b=$(l[m]),c=b.find(".zg-link"),d=c.attr("href"),result.has(d)||(e=c.html(),f=b.find(".details a"),g=parseInt(f[0].innerHTML,10),h=parseInt(f[1].innerHTML,10),i=parseInt(f[2].innerHTML,10),j=parseInt(f[3].innerHTML,10),i>=answerlimit&&j>=agreelimit&&(k=j/i)>=ratiolimit&&g>followerlimit&&result.push({name:e,id:d,follower:g,ask:h,agree:j,answer:i,ratio:k.toFixed(2)}));this.showResult().loadUser()},showResult:function(){var b,a=this.get("result");if(showtable){b=['<table border="1" cellpadding="2"><tr><td>\u7f16\u53f7</td><td>\u7528\u6237\u540d</td><td>\u5173\u6ce8\u8005</td><td>\u63d0\u95ee</td><td>\u56de\u7b54</td><td>\u8d5e\u540c</td><td>\u8d5e\u540c/\u56de\u7b54\u6bd4</td></tr>'];for(var c=0,d=result.length;d>c;c++)b.push("<tr><td>"+(parseInt(c)+1)+"</td><td><a href='/people/"+result[c].id+"/' target='_blank'>"+result[c].name+"</a></td><td>"+result[c].follower+"</td><td>"+result[c].ask+"</td><td>"+result[c].answer+"</td><td>"+result[c].agree+"</td><td>"+result[c].ratio+"</td></tr>");b.push("</table>")}else{b=["\u7f16\u53f7,\u7528\u6237\u540d,\u5173\u6ce8\u8005,\u63d0\u95ee,\u56de\u7b54,\u8d5e\u540c,\u8d5e\u540c/\u56de\u7b54\u6bd4<ul>"];for(var c=0,d=result.length;d>c;c++)b.push("<li><span>"+(parseInt(c)+1)+"</span>,<a href='/people/"+result[c].id+"/' target='_blank'>"+result[c].name+"</a>,<span>"+result[c].follower+"</span>,<span>"+result[c].ask+"</span>,<span>"+result[c].answer+"</span>,<span>"+result[c].agree+"</span>,<span>"+result[c].ratio+"</span></li>");b.push("</ul>")}return a.html(b.join("")),this},sortResult:function(a){var b;if(!result.isEmpty()){if(curSortBtn){if(curSortBtn[0]==a[0])return;curSortBtn.removeClass(strings.greyClass).addClass(strings.greenClass)}curSortBtn=a,curSortBtn.removeClass(strings.greenClass).addClass(strings.greyClass),b=curSortBtn.data("type"),result=[].sort.call(result,function(a,c){return c[b]-a[b]}),this.showResult()}},showMessage:function(a){var b=messages[a],c=[].slice.call(arguments);return b=b.replace(rparam,function(a,b){return c[b]}),this.get("message").html(b),this},success:function(){this.showMessage("success",userIndex,result.length),this.hideIcon()},close:function(){confirm(messages.quit)&&(this.el.hide(),$(".sta-mask").hide())},showIcon:function(){this.get("icon").show()},hideIcon:function(){this.get("icon").hide()}};statistic.ATTR={message:".sta-msg",icon:"img",result:".sta-result",viewBtn:".sta-change-btn",iframe:"#tempframe"},statistic.EVENT={".sta-btn":{click:function(a){var b=$(a.target);this[b.data("action")](b)}}},statistic.init();